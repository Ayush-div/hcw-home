<app-header [title]="'Join Consultation'"></app-header>

<ion-content class="custom-content" fullscreen>
  <ion-grid class="main-container">
    <ion-row class="panel-container" justify-content-center>

      <!-- Left Panel: Terms & Approvals -->
      <ion-col size="12" size-md="6" class="panel left-panel">
        <ion-card class="full-height">
          <ion-card-header>
            <ion-card-title>Review & Accept Terms</ion-card-title>
          </ion-card-header>

          <ion-card-content>
            <!-- Intro Text -->
            <p class="description">
              Please read our
              <span class="link-text" (click)="redirectToTerms()">Terms & Conditions</span>

              carefully before joining the consultation.
            </p>

            <!-- Approvals Form -->
            <form [formGroup]="form" (ngSubmit)="join()" aria-describedby="requirements">
              <p id="requirements" class="sr-only">
                All required approvals must be checked to enable the Join button.
              </p>

              <!-- Accept Terms -->
              <ion-item lines="none" class="check-item">
                <ion-checkbox slot="start" formControlName="acceptTerms" aria-describedby="terms-desc"></ion-checkbox>
                <ion-label>
                  I have read and accept the
                  <span class="link-text" (click)="redirectToTerms()">Terms & Conditions</span>
                </ion-label>
              </ion-item>
              <div id="terms-desc" class="assistive">Required to proceed.</div>



            </form>
          </ion-card-content>
        </ion-card>
      </ion-col>

      <!-- Right Panel: Join CTA -->
      <ion-col size="12" size-md="6" class="panel right-panel">
        <ion-card class="full-height cta-card">
          <ion-card-header>
            <ion-card-title>Join Consultation</ion-card-title>
          </ion-card-header>

          <ion-card-content class="cta-content">
            <p class="status" [ngClass]="{ 'ok': canJoin, 'blocked': !canJoin }">
              {{ canJoin ? 'You are ready to join.' : 'Please approve the items on the left to continue.' }}
            </p>

            <ion-button expand="block" color="primary" class="join-btn" [disabled]="!canJoin"
              [attr.aria-disabled]="!canJoin" (click)="join()">
              Join Consultation
            </ion-button>

            <p class="fineprint">
              By joining, you confirm that you accept the listed terms.
              Review the <span class="link-text" (click)="redirectToTerms()">full details</span>
            </p>
          </ion-card-content>
        </ion-card>
      </ion-col>

    </ion-row>
  </ion-grid>
</ion-content>